{"version":3,"file":"crispy-formset-modal.min.js","sources":["../../../../js/src/icons.js","../../../../js/src/utils.js","../../../../js/src/formset.js","../../../../js/src/modal.js","../../../../js/src/modal-form.js","../../../../js/src/formset-modal.js","../../../../js/src/index.js"],"sourcesContent":["const bootstrapPencilIcon = `\r\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-pencil\" viewBox=\"0 0 16 16\">\r\n    <path d=\"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z\"/>\r\n</svg>\r\n`;\r\n\r\nconst tailwindPencilIcon = `\r\n<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n  <path d=\"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z\" />\r\n</svg>\r\n`;\r\n\r\nexport { bootstrapPencilIcon, tailwindPencilIcon };\r\n","import { bootstrapPencilIcon, tailwindPencilIcon } from \"./icons\";\r\n\r\nlet gettext = window.gettext;\r\nconst _has = Object.prototype.hasOwnProperty;\r\n/**\r\n * Checks if the object has the property passed as argument\r\n */\r\nexport function has(object, key) {\r\n  return _has.call(object, key);\r\n}\r\n\r\nexport function uuidv4() {\r\n  function randomHex() {\r\n    return Math.floor((1 + Math.random()) * 0x10000)\r\n      .toString(16)\r\n      .substring(1);\r\n  }\r\n\r\n  const part1 = randomHex() + randomHex();\r\n  const part2 = randomHex();\r\n  const part3 = ((parseInt(randomHex(), 16) & 0x0fff) | 0x4000).toString(16);\r\n  const part4 = ((parseInt(randomHex(), 16) & 0x3fff) | 0x8000).toString(16);\r\n  const part5 = randomHex() + randomHex() + randomHex();\r\n\r\n  return `${part1}-${part2}-${part3}-${part4}-${part5}`;\r\n}\r\n\r\nexport function getTextValue(el) {\r\n  let type = el.tagName.toLowerCase();\r\n  let textValue = \"\";\r\n  if (type === \"select\") {\r\n    let tempDiv = document.createElement(\"div\");\r\n    tempDiv.innerHTML = el.options[el.selectedIndex].innerText;\r\n    textValue = tempDiv.innerText\r\n      .split(\"\\n\")\r\n      .map((item) => item.trim())\r\n      .join(\" \")\r\n      .trim();\r\n  } else {\r\n    if (has(el, \"inputmask\")) {\r\n      textValue = el.inputmask.undoValue;\r\n    } else {\r\n      if (el.getAttribute(\"type\") == \"date\") {\r\n        if (el.value) {\r\n          textValue = el.value;\r\n        }\r\n      } else {\r\n        if (el.getAttribute(\"type\") == \"checkbox\") {\r\n          textValue = el.checked ? \"on\" : \"off\";\r\n        } else {\r\n          textValue = el.value;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return textValue;\r\n}\r\n\r\nexport function getNumberValue(value) {\r\n  return Number(value);\r\n}\r\n\r\nexport function executeAllCalculatedFields() {\r\n  if (window.hasOwnProperty(\"calculatedFields\")) {\r\n    calculatedFields.forEach(function (obj) {\r\n      obj.executeAll();\r\n    });\r\n  }\r\n}\r\n\r\nexport function hookCalculatedFields() {\r\n  if (window.hasOwnProperty(\"calculatedFields\")) {\r\n    window.calculatedFields.forEach(function (obj) {\r\n      let el = obj.field;\r\n      let id = el.getAttribute(\"id\");\r\n      let column = document.querySelector(\"td[data-source='\" + id + \"']\");\r\n      if (column) {\r\n        if (!el.hasAttribute(\"data-event\")) {\r\n          el.addEventListener(\"oncalculate\", function () {\r\n            let content = getTextValue(el);\r\n            // The column element is refetched since the table is recreated on each event\r\n            let _column = document.querySelector(\r\n              \"td[data-source='\" + id + \"']\"\r\n            );\r\n            if (_column) {\r\n              _column.innerText = content;\r\n            }\r\n          });\r\n          el.setAttribute(\"data-event\", true);\r\n        }\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nexport function removeChildren(a) {\r\n  while (a.hasChildNodes()) {\r\n    a.removeChild(a.lastChild);\r\n  }\r\n}\r\n\r\nexport function injectStyles() {\r\n  const css = `\r\n    .cfm-selection-border {\r\n        position: absolute;\r\n        top: 0px;\r\n        bottom: 0px;\r\n        left: 0px;\r\n        width: 0.150rem;\r\n        background-color: rgb(220 53 69 / 1);\r\n    }\r\n    .cfm-modal-backdrop {\r\n        position: fixed;\r\n        inset: 0px;\r\n        z-index: 100;\r\n        background-color: rgb(31 41 55 / 1);\r\n        opacity: 0;\r\n        transition-property: opacity;\r\n        transition-duration: 300ms;\r\n        transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\r\n    }\r\n    .cfm-opacity-50 {\r\n        opacity: 0.5;\r\n    }\r\n    .cfm-opacity-100 {\r\n        opacity: 1;\r\n    }\r\n    .cfm-tr.selected{\r\n      background-color: rgba(0, 0, 0, 0.08) !important;\r\n    }\r\n    .cfm .modal-body {\r\n      max-height: calc(100vh - 150px);\r\n      overflow-x: auto;\r\n    }\r\n    .cfm-cursor-pointer {\r\n      cursor: pointer;\r\n    }\r\n    `;\r\n  const style = document.createElement(\"style\");\r\n  style.innerHTML = css;\r\n  document.head.appendChild(style);\r\n}\r\n\r\nexport function getModalInstance(id, instances) {\r\n  if (instances.some((modalInstance) => modalInstance.id === id)) {\r\n    return instances.find((modalInstance) => modalInstance.id === id);\r\n  }\r\n  return false;\r\n}\r\n\r\nexport function ready(fn) {\r\n  if (document.readyState !== \"loading\") {\r\n    fn();\r\n  } else {\r\n    document.addEventListener(\"DOMContentLoaded\", fn);\r\n  }\r\n}\r\n\r\nif (!window.django || !window.django.jsi18n_initialized) {\r\n  gettext = (msg) => msg;\r\n}\r\n\r\nconst bootstrap4Classes = {\r\n  hidden: \"d-none\",\r\n  inlineFlex: \"d-inline-flex\",\r\n  flex: \"d-flex\",\r\n  relative: \"position-relative\",\r\n  textRight: \"text-right\",\r\n  textCenter: \"text-center\",\r\n  alignMiddle: \"align-middle\",\r\n  pointer: \"cfm-cursor-pointer\",\r\n  editBtn: \"btn-open-row btn btn-sm btn-primary\",\r\n  checkbox: \"checkbox\",\r\n  td: \"cfm-td\",\r\n  tr: \"cfm-tr\",\r\n  selectionMark: \"cfm-selection-border\",\r\n  p0: \"p-0\",\r\n  opacity50: \"cfm-opacity-50\",\r\n  opacity100: \"cfm-opacity-100\",\r\n  backdrop: \"cfm-modal-backdrop\",\r\n  justifyStart: \"justify-content-start\",\r\n  justifyCenter: \"justify-content-center\",\r\n  justifyEnd: \"justify-content-end\",\r\n  itemsStart: \"align-items-start\",\r\n  itemsCenter: \"align-items-center\",\r\n  itemsEnd: \"align-items-end\",\r\n};\r\n\r\nconst bootstrap5Classes = {\r\n  ...bootstrap4Classes,\r\n  textRight: \"text-end\",\r\n};\r\n\r\nconst tailwindClasses = {\r\n  hidden: \"hidden\",\r\n  inlineFlex: \"inline-flex\",\r\n  flex: \"flex\",\r\n  relative: \"relative\",\r\n  textRight: \"text-right\",\r\n  textCenter: \"text-center\",\r\n  alignMiddle: \"align-middle\",\r\n  pointer: \"cursor-pointer\",\r\n  editBtn:\r\n    \"btn-open-row mx-auto p-1 border border-transparent rounded-full shadow-sm text-gray-500 bg-gray-100 hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500\",\r\n  checkbox:\r\n    \"w-4 rounded border-gray-300 focus:ring-indigo-500 text-indigo-600 h-4\",\r\n  td: \"whitespace-nowrap px-3 py-3 text-sm text-gray-500\",\r\n  tr: \"divide-x divide-gray-200 border-b\",\r\n  selectionMark:\r\n    \"absolute inset-y-0 left-0 w-0.5 bg-indigo-600 selection-border\",\r\n  p0: \"p-0\",\r\n  opacity50: \"opacity-50\",\r\n  opacity100: \"opacity-100\",\r\n  backdrop:\r\n    \"transition-opacity ease-in-out duration-300 opacity-0 bg-gray-800 fixed inset-0 z-40\",\r\n  justifyStart: \"justify-start\",\r\n  justifyCenter: \"justify-center\",\r\n  justifyEnd: \"justify-end\",\r\n  itemsStart: \"items-start\",\r\n  itemsCenter: \"items-center\",\r\n  itemsEnd: \"items-end\",\r\n};\r\n\r\nconst bulmaClasses = {\r\n  hidden: \"is-hidden\",\r\n  inlineFlex: \"is-inline-flex\",\r\n  flex: \"is-flex\",\r\n  relative: \"is-relative\",\r\n  textRight: \"has-text-right\",\r\n  textCenter: \"has-text-center\",\r\n  alignMiddle: \"is-vcentered\",\r\n  pointer: \"cfm-cursor-pointer\",\r\n  editBtn: \"btn-open-row button is-primary is-small\",\r\n  checkbox: \"checkbox\",\r\n  td: \"cfm-td\",\r\n  tr: \"cfm-tr\",\r\n  selectionMark: \"cfm-selection-border\",\r\n  p0: \"p-0\",\r\n  opacity50: \"cfm-opacity-50\",\r\n  opacity100: \"cfm-opacity-100\",\r\n  backdrop: \"cfm-modal-backdrop\",\r\n  justifyStart: \"is-justify-content-start\",\r\n  justifyCenter: \"is-justify-content-center\",\r\n  justifyEnd: \"is-justify-content-end\",\r\n  itemsStart: \"is-align-items-start\",\r\n  itemsCenter: \"is-align-items-center\",\r\n  itemsEnd: \"is-align-items-end\",\r\n};\r\n\r\nconst tailwindSizeClasses = {\r\n  sm: \"max-w-lg\",\r\n  md: \"max-w-4xl\",\r\n  lg: \"max-w-5xl\",\r\n  xl: \"max-w-6xl\",\r\n};\r\n\r\nconst bootstrap4SizeClasses = {\r\n  sm: \"modal-sm\",\r\n  md: \"modal-md\",\r\n  lg: \"modal-lg\",\r\n  xl: \"modal-xl\",\r\n};\r\n\r\nconst bootstrap5SizeClasses = bootstrap4SizeClasses;\r\n\r\nconst bulmaSizeClasses = {\r\n  sm: \"modal-sm\",\r\n  md: \"modal-md\",\r\n  lg: \"modal-lg\",\r\n  xl: \"modal-xl\",\r\n};\r\n\r\nconst templatePacks = {\r\n  bootstrap4: {\r\n    classes: bootstrap4Classes,\r\n    sizes: bootstrap4SizeClasses,\r\n    pencilIcon: bootstrapPencilIcon,\r\n  },\r\n  bootstrap5: {\r\n    classes: bootstrap5Classes,\r\n    sizes: bootstrap5SizeClasses,\r\n    pencilIcon: bootstrapPencilIcon,\r\n  },\r\n  tailwind: {\r\n    classes: tailwindClasses,\r\n    sizes: tailwindSizeClasses,\r\n    pencilIcon: tailwindPencilIcon,\r\n  },\r\n  bulma: {\r\n    classes: bulmaClasses,\r\n    sizes: bulmaSizeClasses,\r\n    pencilIcon: bootstrapPencilIcon,\r\n  },\r\n};\r\n\r\nexport { gettext, bootstrap4Classes, templatePacks };\r\n","/**\r\n* Django formset helper\r\n* Copyright (c) 2013, Ionata Web Solutions\r\n* All rights reserved.\r\n*\r\n* Redistribution and use in source and binary forms, with or without\r\n* modification, are permitted provided that the following conditions are met:\r\n*\r\n* Redistributions of source code must retain the above copyright notice, this\r\n* list of conditions and the following disclaimer.\r\n*\r\n* Redistributions in binary form must reproduce the above copyright notice, this\r\n* list of conditions and the following disclaimer in the documentation and/or\r\n* other materials provided with the distribution.\r\n*\r\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\n* ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n* WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\r\n* DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\r\n* FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\r\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n* SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\r\n* CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\r\n* OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\r\n* OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n*/\r\n\r\nimport { uuidv4 } from \"./utils\";\r\nimport $ from \"jquery\";\r\n\r\nexport const pluginName = 'formset';\r\n\r\n\r\nclass Formset {\r\n    constructor(el, options) {\r\n        var _this = this;\r\n\r\n        //Defaults:\r\n        this.opts = $.extend({}, Formset.defaults, options);\r\n\r\n        this.$formset = $(el);\r\n        this.$formset.attr(\"data-uuid\", uuidv4());\r\n        this.$emptyForm = this.$formset.find(this.opts.emptyForm);\r\n        this.$body = this.$formset.find(this.opts.body);\r\n        this.$add = this.$formset.find(this.opts.add);\r\n\r\n        this.formsetPrefix = $(el).data('formset-prefix');\r\n\r\n        // Bind to the `Add form` button\r\n        this.addForm = $.proxy(this, 'addForm');\r\n        this.$add.click(this.addForm);\r\n\r\n        // Bind receiver to `formAdded` and `formDeleted` events\r\n        this.$formset.on('formAdded formDeleted', this.opts.form, $.proxy(this, 'checkMaxForms'));\r\n\r\n        // Set up the existing forms\r\n        this.$forms().each(function (i, form) {\r\n            var $form = $(form);\r\n            _this.bindForm($(this), i);\r\n        });\r\n\r\n        // Store a reference to this in the formset element\r\n        this.$formset.data(pluginName, this);\r\n\r\n        var extras = ['animateForms'];\r\n        $.each(extras, function (i, extra) {\r\n            if ((extra in _this.opts) && (_this.opts[extra])) {\r\n                _this[extra]();\r\n            }\r\n        });\r\n    }\r\n    static getOrCreate(el, options) {\r\n        var rev = $(el).data(pluginName);\r\n        if (!rev) {\r\n            rev = new Formset(el, options);\r\n        }\r\n\r\n        return rev;\r\n    }\r\n    addForm() {\r\n        // Don't proceed if the number of maximum forms has been reached\r\n        if (this.hasMaxForms()) {\r\n            throw new Error(\"MAX_NUM_FORMS reached\");\r\n        }\r\n\r\n        var newIndex = this.totalFormCount();\r\n        this.$managementForm('TOTAL_FORMS').val(newIndex + 1);\r\n\r\n        var newFormHtml = this.$emptyForm.html()\r\n            .replace(new RegExp('__prefix__', 'g'), newIndex)\r\n            .replace(new RegExp('<\\\\\\\\/script>', 'g'), '</script>');\r\n\r\n        var $newFormFragment = $($.parseHTML(newFormHtml, this.$body.document, true));\r\n        this.$body.append($newFormFragment);\r\n\r\n        var $newForm = $newFormFragment.filter(this.opts.form);\r\n        this.bindForm($newForm, newIndex);\r\n        if (this.opts.newFormCallback) {\r\n            this.opts.newFormCallback($newForm);\r\n        }\r\n        return $newForm;\r\n    }\r\n    /**\r\n    * Attach any events needed to a new form\r\n    */\r\n    bindForm($form, index) {\r\n        var prefix = this.formsetPrefix + '-' + index;\r\n        $form.data(pluginName + '__formPrefix', prefix);\r\n\r\n        var $delete = $form.find('[name=' + prefix + '-DELETE]');\r\n\r\n        // Trigger `formAdded` / `formDeleted` events when delete checkbox value changes\r\n        $delete.change(function (event) {\r\n            if ($delete.is(':checked')) {\r\n                $form.attr('data-formset-form-deleted', '');\r\n                // Remove required property and pattern attribute to allow submit, back it up to data field\r\n                $form.find(':required').data(pluginName + '-required-field', true).prop('required', false);\r\n                $form.find('input[pattern]').each(function () {\r\n                    var pattern = $(this).attr('pattern');\r\n                    $(this).data(pluginName + '-field-pattern', pattern).removeAttr('pattern');\r\n                });\r\n                $form.trigger('formDeleted');\r\n            } else {\r\n                $form.removeAttr('data-formset-form-deleted');\r\n                // Restore required property and pattern attributes from data field\r\n                $form.find('*').filter(function () {\r\n                    return $(this).data(pluginName + '-required-field') === true;\r\n                }).prop('required', true);\r\n                $form.find('input').each(function () {\r\n                    var pattern = $(this).data(pluginName + '-field-pattern');\r\n                    if (pattern) {\r\n                        $(this).attr('pattern', pattern);\r\n                    }\r\n                });\r\n                $form.trigger('formAdded');\r\n            }\r\n        }).trigger('change');\r\n\r\n        var $deleteButton = $form.find(this.opts.deleteButton);\r\n\r\n        $deleteButton.bind('click', function () {\r\n            $delete.attr('checked', true).change();\r\n        });\r\n    }\r\n    $forms() {\r\n        return this.$body.find(this.opts.form);\r\n    }\r\n    $managementForm(name) {\r\n        return this.$formset.find('[name=' + this.formsetPrefix + '-' + name + ']');\r\n    }\r\n    totalFormCount() {\r\n        return this.$forms().length;\r\n    }\r\n    deletedFormCount() {\r\n        return this.$forms().filter('[data-formset-form-deleted]').length;\r\n    }\r\n    clear() {\r\n        this.$forms().each(function (key, row) {\r\n            $(row).find(':input').not(':button, :submit, :reset, :hidden, :checkbox, :radio').val('');\r\n        });\r\n    }\r\n    deleteAll() {\r\n        this.$forms().each(function (key, row) {\r\n            $(row).find('[deletecheckbox]').prop(\"checked\", true).change();\r\n        });\r\n    }\r\n    activeFormCount() {\r\n        return this.totalFormCount() - this.deletedFormCount();\r\n    }\r\n    openRownum() {\r\n        var rownum = this.$formset.find('tr.row-open').attr('data-rownum');\r\n        return typeof rownum != undefined ? parseInt(rownum) : 0;\r\n    }\r\n    hasMaxForms() {\r\n        var maxForms = parseInt(this.$managementForm('MAX_NUM_FORMS').val(), 10) || 1000;\r\n        return this.activeFormCount() >= maxForms;\r\n    }\r\n    checkMaxForms() {\r\n        if (this.hasMaxForms()) {\r\n            this.$formset.addClass(this.opts.hasMaxFormsClass);\r\n            this.$add.attr('disabled', 'disabled');\r\n        } else {\r\n            this.$formset.removeClass(this.opts.hasMaxFormsClass);\r\n            this.$add.removeAttr('disabled');\r\n        }\r\n    }\r\n    animateForms() {\r\n        this.$formset.on('formAdded', this.opts.form, function () {\r\n            var $form = $(this);\r\n            $form.slideUp(0);\r\n            $form.slideDown();\r\n        }).on('formDeleted', this.opts.form, function () {\r\n            var $form = $(this);\r\n            $form.slideUp();\r\n        });\r\n        this.$forms().filter('[data-formset-form-deleted]').slideUp(0);\r\n    }\r\n}\r\n\r\nFormset.defaults = {\r\n    form: '[data-formset-form]',\r\n    emptyForm: 'script[type=form-template][data-formset-empty-form]',\r\n    body: '[data-formset-body]',\r\n    add: '[data-formset-add]',\r\n    deleteButton: '[data-formset-delete-button]',\r\n    hasMaxFormsClass: 'has-max-forms',\r\n    animateForms: false,\r\n    newFormCallback: false\r\n};\r\n\r\nexport default Formset;\r\n","import { uuidv4, templatePacks } from \"./utils\";\r\n\r\nconst modalDefault = {\r\n  placement: \"center\",\r\n  size: \"md\",\r\n  templatePack: null,\r\n  onHide: () => {},\r\n  onShow: () => {},\r\n  onToggle: () => {},\r\n};\r\n\r\nclass Modal {\r\n  constructor(targetEl = null, options = {}) {\r\n    this._targetEl = targetEl;\r\n    this._parentEl = targetEl.parentElement;\r\n    this._options = {\r\n      ...modalDefault,\r\n      ...options,\r\n    };\r\n    this._isHidden = true;\r\n    this._init();\r\n    this._addEventListeners();\r\n  }\r\n  _init() {\r\n    this._getPlacementClasses().map((c) => {\r\n      this._targetEl.classList.add(c);\r\n    });\r\n    this._clearSize();\r\n    this._getSizeClasses().map((c) => {\r\n      this._targetEl.firstElementChild.classList.add(c);\r\n    });\r\n  }\r\n  _createBackdrop(id) {\r\n    if (this._isHidden) {\r\n      const backdropEl = document.createElement(\"div\");\r\n      backdropEl.setAttribute(\"data-ref-id\", id);\r\n      backdropEl.setAttribute(\"modal-backdrop\", \"\");\r\n      backdropEl.classList.add(...this._getClasses(\"backdrop\"));\r\n      this._parentEl.append(backdropEl);\r\n      backdropEl.offsetWidth;\r\n      backdropEl.classList.add(...this._getClasses(\"opacity50\"));\r\n    }\r\n  }\r\n  _destroyBackdropEl() {\r\n    if (!this._isHidden) {\r\n      let id = this._targetEl.getAttribute(\"data-ref-id\");\r\n      document.querySelector(`[modal-backdrop][data-ref-id=\"${id}\"]`).remove();\r\n    }\r\n  }\r\n  _getPlacementClasses() {\r\n    let that = this;\r\n    switch (this._options.placement) {\r\n      // top\r\n      case \"top-left\":\r\n        return [\r\n          that._getClasses(\"justifyStart\", false),\r\n          that._getClasses(\"itemsStart\", false),\r\n        ];\r\n      case \"top-center\":\r\n        return [\r\n          that._getClasses(\"justifyCenter\", false),\r\n          that._getClasses(\"itemsStart\", false),\r\n        ];\r\n      case \"top-right\":\r\n        return [\r\n          that._getClasses(\"justifyEnd\", false),\r\n          that._getClasses(\"itemsStart\", false),\r\n        ];\r\n\r\n      // center\r\n      case \"center-left\":\r\n        return [\r\n          that._getClasses(\"justifyStart\", false),\r\n          that._getClasses(\"itemsCenter\", false),\r\n        ];\r\n      case \"center\":\r\n        return [\r\n          that._getClasses(\"justifyCenter\", false),\r\n          that._getClasses(\"itemsCenter\", false),\r\n        ];\r\n      case \"center-right\":\r\n        return [\r\n          that._getClasses(\"justifyEnd\", false),\r\n          that._getClasses(\"itemsCenter\", false),\r\n        ];\r\n\r\n      // bottom\r\n      case \"bottom-left\":\r\n        return [\r\n          that._getClasses(\"justifyStart\", false),\r\n          that._getClasses(\"itemsEnd\", false),\r\n        ];\r\n      case \"bottom-center\":\r\n        return [\r\n          that._getClasses(\"justifyCenter\", false),\r\n          that._getClasses(\"itemsEnd\", false),\r\n        ];\r\n      case \"bottom-right\":\r\n        return [\r\n          that._getClasses(\"justifyEnd\", false),\r\n          that._getClasses(\"itemsEnd\", false),\r\n        ];\r\n\r\n      default:\r\n        return [\r\n          that._getClasses(\"justifyCenter\", false),\r\n          that._getClasses(\"itemsCenter\", false),\r\n        ];\r\n    }\r\n  }\r\n  _getSizeClasses() {\r\n    return templatePacks[this._options.templatePack].sizes[\r\n      this._options.size\r\n    ].split(\" \");\r\n  }\r\n  _getClasses(name, str = false) {\r\n    let names = templatePacks[this._options.templatePack].classes[name];\r\n    return str ? names : names.split(\" \");\r\n  }\r\n  _clearSize() {\r\n    const element = this._targetEl.firstElementChild;\r\n    const obj = templatePacks[this._options.templatePack].sizes;\r\n    for (const key in obj) {\r\n      if (obj.hasOwnProperty(key)) {\r\n        element.classList.remove(obj[key]);\r\n      }\r\n    }\r\n  }\r\n  _addEventListeners() {\r\n    let that = this;\r\n    this._targetEl.addEventListener(\"keyup\", function (e) {\r\n      if (e.key === \"Escape\") {\r\n        that.hide();\r\n      }\r\n    });\r\n  }\r\n  toggle() {\r\n    if (this._isHidden) {\r\n      this.show();\r\n    } else {\r\n      this.hide();\r\n    }\r\n\r\n    // callback function\r\n    this._options.onToggle(this);\r\n  }\r\n  show() {\r\n    const id = uuidv4();\r\n    this._targetEl.classList.add(...this._getClasses(\"flex\"));\r\n    this._targetEl.classList.remove(...this._getClasses(\"hidden\"));\r\n    this._targetEl.setAttribute(\"aria-modal\", \"true\");\r\n    this._targetEl.setAttribute(\"role\", \"dialog\");\r\n    this._targetEl.removeAttribute(\"aria-hidden\");\r\n    this._targetEl.setAttribute(\"data-ref-id\", id);\r\n    this._createBackdrop(id);\r\n    this._isHidden = false;\r\n\r\n    document.body.classList.add(\"modal-open\");\r\n\r\n    // callback function\r\n    this._options.onShow(this);\r\n\r\n    let firstEl = this._targetEl.querySelector(\r\n      'select, input:not([type=\"hidden\"]'\r\n    );\r\n    if (firstEl) {\r\n      firstEl.setAttribute(\"tabindex\", \"0\");\r\n      firstEl.focus();\r\n    }\r\n    this._targetEl.offsetWidth;\r\n    this._targetEl.classList.add(...this._getClasses(\"opacity100\"));\r\n  }\r\n  hide() {\r\n    this._targetEl.classList.add(...this._getClasses(\"hidden\"));\r\n    this._targetEl.classList.remove(...this._getClasses(\"flex\"));\r\n    this._targetEl.setAttribute(\"aria-hidden\", \"true\");\r\n    this._targetEl.removeAttribute(\"aria-modal\");\r\n    this._targetEl.removeAttribute(\"role\");\r\n    this._destroyBackdropEl();\r\n    this._isHidden = true;\r\n\r\n    document.body.classList.remove(\"modal-open\");\r\n\r\n    // callback function\r\n    this._options.onHide(this);\r\n  }\r\n}\r\n\r\nexport default Modal;\r\n","import Modal from \"./modal\";\r\nimport { gettext } from \"./utils\";\r\n\r\nconst modalFormOptions = {\r\n  parent: null,\r\n  modalId: null,\r\n  onKeyUp: function () {},\r\n  onClose: function () {},\r\n  onOpen: function () {},\r\n};\r\n\r\nclass ModalForm {\r\n  constructor(targetEl, options = {}) {\r\n    this.targetEl = targetEl;\r\n    this._options = {\r\n      ...modalFormOptions,\r\n      ...options,\r\n    };\r\n    this.modalId = this._options.modalId;\r\n    this._modalEl = null;\r\n    this._modalTitleEl = null;\r\n    this._modalDeleteBt = null;\r\n    this.modalInstance = false;\r\n    this.rownum = null;\r\n    this._init();\r\n    this._addEvents();\r\n  }\r\n  _init() {\r\n    this._modalEl = document.getElementById(this.modalId);\r\n    this._modalTitleEl = this._modalEl.querySelector(\".modal-title\");\r\n    this._modalDeleteBt = this._modalEl.querySelector(\".formset-delete\");\r\n    this._createModal();\r\n  }\r\n  _addEvents() {\r\n    let that = this;\r\n    this._modalEl\r\n      .querySelectorAll('[data-formset-modal-toggle=\"' + this.modalId + '\"]')\r\n      .forEach(function (el) {\r\n        el.addEventListener(\"click\", function () {\r\n          that.close();\r\n        });\r\n      });\r\n  }\r\n  hasFieldError(fieldId) {\r\n    let fieldWrapper = this.targetEl.querySelector(`#div_${fieldId}`);\r\n    let hasError = false;\r\n    let errorText = \"\";\r\n    fieldWrapper\r\n      .querySelectorAll(\"[id^='error_']\")\r\n      .forEach(function (el) {\r\n        hasError = true;\r\n        errorText = el.innerText;\r\n      });\r\n    return { error: hasError, text: errorText };\r\n  }\r\n  hasNonFieldError() {\r\n    return this.targetEl.querySelector(\".non-field-errors\") != null;\r\n  }\r\n  _hiddeDefaultDeleteBt(el) {\r\n    let parentEl = el.parentNode;\r\n    parentEl.classList.add(\"d-none\");\r\n  }\r\n  _createModal() {\r\n    let that = this;\r\n    if (!this.modalInstance) {\r\n      let deleteBt = this.targetEl.querySelector(\".formset-delete\");\r\n      let modal = new Modal(this._modalEl, {\r\n        placement: that._options.placement,\r\n        size: that._options.size,\r\n        templatePack: that._options.templatePack,\r\n        onHide: function (modal) {\r\n          that._onModalClose(modal);\r\n        },\r\n        onShow: function (modal) {\r\n          that._onModalShow(modal);\r\n        },\r\n      });\r\n      modal._targetEl.addEventListener(\"keyup\", function (e) {\r\n        that._options.onKeyUp(e, that);\r\n      });\r\n      this.modalInstance = modal;\r\n      this._hiddeDefaultDeleteBt(deleteBt);\r\n    }\r\n  }\r\n  _onModalShow(modal) {\r\n    this._options.onOpen(this);\r\n    let openRowBt = this._options.parent.targetEl.querySelector(\r\n      \".btn-open-row[data-formset-modal-toggle='\" + this.modalId + \"']\"\r\n    );\r\n    let tr = openRowBt.closest(\"tr\");\r\n    this._modalTitleEl.innerText = gettext(\"Editing row #\") + this.rownum;\r\n    tr.classList.add(\"row-open\");\r\n  }\r\n  _onModalClose(modal) {\r\n    this._options.onClose(this);\r\n    let openRowBt = this._options.parent.targetEl.querySelector(\r\n      \".btn-open-row[data-formset-modal-toggle='\" + this.modalId + \"']\"\r\n    );\r\n    if (openRowBt) {\r\n      let tr = openRowBt.closest(\"tr\");\r\n      tr.classList.remove(\"row-open\");\r\n    }\r\n  }\r\n  isDeleted() {\r\n    return this.targetEl.hasAttribute(\"data-formset-form-deleted\");\r\n  }\r\n  isSelected() {\r\n    return this.targetEl.hasAttribute(\"data-formset-form-selected\");\r\n  }\r\n  open() {\r\n    this.modalInstance.show();\r\n  }\r\n  close() {\r\n    this.modalInstance.hide();\r\n  }\r\n}\r\n\r\nexport default ModalForm;\r\n","import $ from \"jquery\";\r\nimport ModalForm from \"./modal-form\";\r\nimport {\r\n  executeAllCalculatedFields,\r\n  getNumberValue,\r\n  getTextValue,\r\n  gettext,\r\n  hookCalculatedFields,\r\n  removeChildren,\r\n  templatePacks,\r\n  uuidv4,\r\n} from \"./utils\";\r\n\r\nconst variant = {\r\n  tabular: \"tabular\",\r\n  stacked: \"stacked\",\r\n  modal: \"modal\",\r\n};\r\n\r\nconst formsetOptions = {\r\n  editText: gettext(\"Edit\"),\r\n};\r\n\r\nclass FormsetModal {\r\n  constructor(elementId) {\r\n    this._id = elementId;\r\n    this.targetEl = document.getElementById(this._id);\r\n    this.variant = variant.tabular;\r\n    this.$formset = null;\r\n    this._options = {\r\n      ...formsetOptions,\r\n    };\r\n    this._modalForms = [];\r\n    this._deleteBt = null;\r\n    this._table = null;\r\n    this._tbody = null;\r\n    this._tfoot = null;\r\n    this._init();\r\n    this._addEvents();\r\n  }\r\n  _init() {\r\n    this.variant = this._getVariant();\r\n    this.templatePack = this._getTemplatePack();\r\n    this.modalSize = this._getModalSize();\r\n    this.modalPlacement = this._getModalPlacement();\r\n    // Create Formset Helper Instance\r\n    this.$formset = $(`#${this._id}`);\r\n    this.$formset.formset({\r\n      animateForms: true,\r\n    });\r\n    if (this.variant === variant.modal || this.variant == variant.tabular) {\r\n      this._table = this.targetEl.querySelector(\"table\");\r\n      this._tbody = this._table.querySelector(\"tbody\");\r\n      this._tfoot = this._table.querySelector(\"tfoot\");\r\n      this._emptyState = this._tbody.innerHTML;\r\n    }\r\n    if (this.variant === variant.modal) {\r\n      this._deleteBt = this.targetEl.querySelector(\".delete-selected\");\r\n      this._checkInitials();\r\n      this._configureSelectAllToggler();\r\n      this._refresh();\r\n    }\r\n  }\r\n  _getVariant() {\r\n    return this.targetEl.getAttribute(\"data-formset-variant\");\r\n  }\r\n  _getTemplatePack() {\r\n    return this.targetEl.getAttribute(\"data-template-pack\");\r\n  }\r\n  _getClasses(name) {\r\n    return templatePacks[this.templatePack].classes[name].split(\" \");\r\n  }\r\n  _getPencilIcon(){\r\n    return templatePacks[this.templatePack].pencilIcon;\r\n  }\r\n  _getModalSize() {\r\n    return this.targetEl.getAttribute(\"data-modal-size\");\r\n  }\r\n  _getModalPlacement() {\r\n    return this.targetEl.getAttribute(\"data-modal-placement\");\r\n  }\r\n  _getModalFormInstanceByRownum(rownum) {\r\n    let instance = false;\r\n    this._modalForms.forEach(function (obj) {\r\n      if (obj.rownum === rownum && !obj.isDeleted()) {\r\n        instance = obj;\r\n      }\r\n    });\r\n    return instance;\r\n  }\r\n  _addEvents() {\r\n    let that = this;\r\n    this.$formset.on(\"formAdded\", function (e) {\r\n      that._onFormsetAdded(e);\r\n    });\r\n    this.$formset.on(\"formDeleted\", function (e) {\r\n      that._onFormsetDeleted(e);\r\n    });\r\n  }\r\n  /**\r\n   * Check if the page loaded form from the server to configure them.\r\n   */\r\n  _checkInitials() {\r\n    let that = this;\r\n    let modals = [];\r\n    this.targetEl\r\n      .querySelectorAll(\"[data-formset-modal-toggle]\")\r\n      .forEach(function (el) {\r\n        let targetEl = el.closest(\"[data-formset-form]\");\r\n        let modalId = el.getAttribute(\"data-formset-modal-toggle\");\r\n        if (!modals.includes(modalId)) {\r\n          that._newModalForm(targetEl, modalId);\r\n        }\r\n        modals.push(modalId);\r\n      });\r\n  }\r\n  _newModalForm(targetEl, modalId) {\r\n    let that = this;\r\n    let options = {\r\n      parent: that,\r\n      modalId: modalId,\r\n      size: that.modalSize,\r\n      placement: that.modalPlacement,\r\n      templatePack: that.templatePack,\r\n      onKeyUp: function (e, modalForm) {\r\n        that._onModalFormKeyUp(e, modalForm);\r\n      },\r\n      onOpen: function (modalForm) {\r\n        that._onModalFormOpen(modalForm);\r\n      },\r\n      onClose: function (modalForm) {\r\n        that._onModalFormClose(modalForm);\r\n      },\r\n    };\r\n    let modalForm = new ModalForm(targetEl, options);\r\n    that._modalForms.push(modalForm);\r\n    return modalForm;\r\n  }\r\n  _onFormsetAdded(e) {\r\n    if (this.variant === variant.modal) {\r\n      let id = uuidv4();\r\n      $(this.targetEl).find(\"#__dialog_id__\").attr(\"id\", id);\r\n      $(this.targetEl)\r\n        .find('[data-formset-modal-toggle=\"__dialog_id__\"]')\r\n        .attr(\"data-formset-modal-toggle\", id);\r\n      let modalForm = this._newModalForm(e.target, id);\r\n      modalForm.open();\r\n    }\r\n    if (window.hasOwnProperty(\"calculatedFields\")) {\r\n      window.resetCalculatedFields();\r\n      hookCalculatedFields();\r\n    }\r\n  }\r\n  _onFormsetDeleted() {\r\n    if (this.variant == variant.modal) {\r\n      this._refresh();\r\n    }\r\n    executeAllCalculatedFields();\r\n  }\r\n  _onModalFormKeyUp(e, modalForm) {\r\n    if (e.ctrlKey && (e.keyCode === 38 || e.keyCode === 40)) {\r\n      e.preventDefault();\r\n      let openRownum = modalForm.rownum;\r\n      let $formset = this.$formset.formset(\"getOrCreate\");\r\n      let activeFormCount = $formset.activeFormCount();\r\n      if (e.keyCode == 38) {\r\n        // Up\r\n        if (openRownum > 1) {\r\n          modalForm.close();\r\n          let previewsModalForm = this._getModalFormInstanceByRownum(\r\n            openRownum - 1\r\n          );\r\n          previewsModalForm.open();\r\n        }\r\n      }\r\n\r\n      if (e.keyCode === 40) {\r\n        // Down\r\n        if (openRownum < activeFormCount) {\r\n          modalForm.close();\r\n          let nextsModalForm = this._getModalFormInstanceByRownum(\r\n            openRownum + 1\r\n          );\r\n          nextsModalForm.open();\r\n        }\r\n        if (openRownum == activeFormCount) {\r\n          modalForm.close();\r\n          $formset.addForm();\r\n        }\r\n      }\r\n    }\r\n  }\r\n  _onModalFormOpen(modalForm) {\r\n    this._refresh();\r\n  }\r\n  _onModalFormClose(modalForm) {\r\n    this._refresh();\r\n  }\r\n  _configureSelectAllToggler() {\r\n    let that = this;\r\n    let table = this._table;\r\n    let toggler = this.targetEl.querySelector(\".select-all\");\r\n    let deleteBt = this.targetEl.querySelector(\".delete-selected\");\r\n\r\n    toggler.addEventListener(\"change\", function (e) {\r\n      let checked = toggler.checked;\r\n      let checkBoxes = table.querySelectorAll(\".select-row\");\r\n      checkBoxes.forEach(function (checkbox) {\r\n        let tr = checkbox.closest(\"tr\");\r\n        let td = checkbox.closest(\"td\");\r\n        let btnOpenRow = tr.querySelector(\"[data-formset-modal-toggle]\");\r\n        let modalId = btnOpenRow.getAttribute(\"data-formset-modal-toggle\");\r\n        let modalEl = document.getElementById(modalId);\r\n        let formsetFormEl = modalEl.closest(\"[data-formset-form]\");\r\n        checkbox.checked = checked;\r\n        that._checker(tr, td, formsetFormEl, checkbox);\r\n      });\r\n    });\r\n\r\n    deleteBt.addEventListener(\"click\", function (e) {\r\n      let formset = that.targetEl;\r\n      let selectedForms = formset.querySelectorAll(\r\n        \"[data-formset-form-selected]\"\r\n      );\r\n      selectedForms.forEach(function (selectedForm) {\r\n        let deleteCheckbox = selectedForm.querySelector(\".formset-delete\");\r\n        deleteCheckbox.checked = true;\r\n        deleteCheckbox.dispatchEvent(new Event(\"change\"));\r\n      });\r\n    });\r\n  }\r\n  _checkSelectAllState() {\r\n    let table = this._table;\r\n    let formset = this.targetEl;\r\n    let deleteBt = formset.querySelector(\".delete-selected\");\r\n    let showDeleteBt = false;\r\n    let selectAllToggler = table.querySelector(\".select-all\");\r\n    let recordCount = table.querySelectorAll(\"tbody tr\").length;\r\n    let selected = table.querySelectorAll(\"tr.selected\").length;\r\n\r\n    if (selected === recordCount && recordCount > 0) {\r\n      selectAllToggler.checked = true;\r\n      selectAllToggler.indeterminate = false;\r\n      showDeleteBt = true;\r\n    } else {\r\n      if (selected != recordCount && selected > 0) {\r\n        selectAllToggler.indeterminate = true;\r\n        selectAllToggler.checked = false;\r\n        showDeleteBt = true;\r\n      }\r\n      if (selected === 0) {\r\n        selectAllToggler.checked = false;\r\n        selectAllToggler.indeterminate = false;\r\n        showDeleteBt = false;\r\n      }\r\n    }\r\n\r\n    if (showDeleteBt) {\r\n      deleteBt.classList.remove(...this._getClasses(\"hidden\"));\r\n      deleteBt.classList.add(...this._getClasses(\"inlineFlex\"));\r\n    } else {\r\n      deleteBt.classList.remove(...this._getClasses(\"inlineFlex\"));\r\n      deleteBt.classList.add(...this._getClasses(\"hidden\"));\r\n    }\r\n  }\r\n  _checker(tr, td, formsetFormEl, checkbox) {\r\n    // remove previous divSel if exists.\r\n    let prevDivSel = td.querySelector(\".cfm-selection-border, .selection-border\");\r\n    if (prevDivSel) {\r\n      prevDivSel.remove();\r\n    }\r\n    if (checkbox.checked) {\r\n      let divSel = document.createElement(\"div\");\r\n      td.classList.add(...this._getClasses(\"relative\"));\r\n      divSel.classList.add(...this._getClasses(\"selectionMark\"));\r\n      td.prepend(divSel);\r\n      formsetFormEl.setAttribute(\"data-formset-form-selected\", \"selected\");\r\n      tr.classList.add(\"selected\");\r\n    } else {\r\n      checkbox.classList.remove(...this._getClasses(\"relative\"));\r\n      tr.classList.remove(\"selected\");\r\n      formsetFormEl.removeAttribute(\"data-formset-form-selected\");\r\n    }\r\n    this._checkSelectAllState();\r\n  }\r\n  _refresh() {\r\n    let that = this;\r\n    let fields = {};\r\n    let fieldNames = [];\r\n    let rows = [];\r\n\r\n    this._table.querySelectorAll(\"[data-field-name]\").forEach(function (el) {\r\n      fields[el.getAttribute(\"data-field-name\")] = {\r\n        type: el.getAttribute(\"data-field-type\"),\r\n        hasSummary: el.hasAttribute(\"data-field-summary\"),\r\n        summary: 0,\r\n      };\r\n    });\r\n\r\n    fieldNames = Object.keys(fields);\r\n\r\n    this._modalForms.forEach(function (modalForm) {\r\n      if (!modalForm.isDeleted()) {\r\n        let row = {};\r\n        modalForm.targetEl\r\n          .querySelectorAll(\"input, select\")\r\n          .forEach(function (el) {\r\n            let match = el.name.match(\r\n              /(?<form>\\w+)-(?<number>\\w+)-(?<name>\\w+)/\r\n            );\r\n            if (match) {\r\n              let name = match.groups.name;\r\n              if (fieldNames.includes(name)) {\r\n                let content = getTextValue(el);\r\n                row[name] = {\r\n                  value: content,\r\n                  sourceId: el.getAttribute(\"id\"),\r\n                };\r\n                row[\"modalForm\"] = modalForm;\r\n              }\r\n            }\r\n          });\r\n        rows.push(row);\r\n      }\r\n    });\r\n\r\n    // Remove all rows\r\n    removeChildren(this._tbody);\r\n\r\n    if (rows.length === 0) {\r\n      this._tbody.innerHTML = this._emptyState;\r\n    }\r\n\r\n    let rownum = 1;\r\n    rows.forEach(function (row) {\r\n      row.modalForm.rownum = rownum;\r\n      // Table row\r\n      let tr = document.createElement(\"tr\");\r\n      tr.classList.add(...that._getClasses(\"tr\"));\r\n      tr.setAttribute(\"data-rownum\", rownum);\r\n      // Highlight row if there are non field errors\r\n      if (row.modalForm.hasNonFieldError()) {\r\n        tr[\"style\"] = \"border: 1px solid #ff4545\";\r\n      }\r\n      // Selection column\r\n      let tdSel = document.createElement(\"td\");\r\n      let selCheckbox = document.createElement(\"input\");\r\n      selCheckbox.setAttribute(\"type\", \"checkbox\");\r\n      selCheckbox.classList.add(...that._getClasses(\"checkbox\"));\r\n      selCheckbox.classList.add(\"select-row\");\r\n      tdSel.appendChild(selCheckbox);\r\n      tdSel.classList.add(...that._getClasses(\"td\"))\r\n      selCheckbox.addEventListener(\"change\", function (e) {\r\n        that._checker(tr, tdSel, row.modalForm.targetEl, e.target);\r\n      });\r\n      tr.appendChild(tdSel);\r\n      // Column for row number\r\n      let tdNumber = document.createElement(\"td\");\r\n      tdNumber.classList.add(...that._getClasses(\"td\"));\r\n      tdNumber.classList.add(...that._getClasses(\"textRight\"));\r\n      tdNumber.classList.add(...that._getClasses(\"pointer\"));\r\n      tdNumber.innerText = rownum;\r\n      tdNumber.addEventListener(\"click\", function () {\r\n        row.modalForm.open();\r\n      });\r\n      tr.appendChild(tdNumber);\r\n      // Mirror columns\r\n      fieldNames.forEach(function (field) {\r\n        let td = document.createElement(\"td\");\r\n        let hasError = row.modalForm.hasFieldError(row[field].sourceId);\r\n        td.classList.add(...that._getClasses(\"td\"));\r\n        if (hasError.error) {\r\n          td[\"style\"] = \"border: 1px solid #ff4545\";\r\n          td[\"title\"] = hasError.text;\r\n        }\r\n        if (fields[field].type === \"bool\") {\r\n          let checked = row[field].value === \"on\" ? \"checked\" : \"\";\r\n          td.innerHTML = `<input type=\"checkbox\" class=\"${that\r\n            ._getClasses(\"checkbox\")\r\n            .join(\" \")}\" ${checked} disabled></input>`;\r\n        } else {\r\n          td.innerText = row[field].value;\r\n        }\r\n        if (fields[field].type === \"numeric\") {\r\n          td.classList.add(...that._getClasses(\"textRight\"));\r\n          if (fields[field].hasSummary) {\r\n            fields[field].summary =\r\n              fields[field].summary + getNumberValue(row[field].value);\r\n          }\r\n        }\r\n        if (fields[field].type === \"bool\" || fields[field].type == \"date\") {\r\n          td.classList.add(...that._getClasses(\"textCenter\"));\r\n        }\r\n        td.setAttribute(\"data-source\", row[field].sourceId);\r\n        tr.appendChild(td);\r\n      });\r\n      // Column for edit button\r\n      let tdEdit = document.createElement(\"td\");\r\n      tdEdit.classList.add(...that._getClasses(\"td\"));\r\n      tdEdit.classList.add(...that._getClasses(\"textCenter\"));\r\n      tdEdit.classList.add(...that._getClasses(\"p0\"));\r\n      tdEdit.classList.add(...that._getClasses(\"alignMiddle\"));\r\n      tdEdit.innerHTML = `\r\n                <button type=\"button\"\r\n                        title=\"${that._options.editText}\" \r\n                        class=\"${that._getClasses(\"editBtn\").join(\" \")}\"\r\n                        data-formset-modal-toggle=\"${row.modalForm.modalId}\">\r\n                        ${that._getPencilIcon()}\r\n                </button>`;\r\n      let button = tdEdit.querySelector(\".btn-open-row\");\r\n\r\n      button.addEventListener(\"click\", function (e) {\r\n        row.modalForm.open();\r\n      });\r\n\r\n      tr.appendChild(tdEdit);\r\n      that._tbody.appendChild(tr);\r\n\r\n      if (row.modalForm.isSelected()) {\r\n        selCheckbox.checked = true;\r\n        that._checker(tr, tdSel, row.modalForm.targetEl, selCheckbox);\r\n      }\r\n\r\n      rownum++;\r\n    });\r\n\r\n    if (this._tfoot) {\r\n      this._tfoot\r\n        .querySelectorAll(\"[data-summary-column]\")\r\n        .forEach(function (el) {\r\n          let summary = fields[el.getAttribute(\"data-summary-column\")].summary;\r\n          el.innerText = summary;\r\n        });\r\n    }\r\n\r\n    this._checkSelectAllState();\r\n  }\r\n}\r\n\r\nexport default FormsetModal;\r\n","import $ from \"jquery\";\r\nimport Formset, { pluginName } from \"./formset\";\r\nimport FormsetModal from \"./formset-modal\";\r\nimport Modal from \"./modal\";\r\nimport {\r\n  executeAllCalculatedFields,\r\n  getModalInstance,\r\n  hookCalculatedFields,\r\n  ready,\r\n  injectStyles,\r\n} from \"./utils\";\r\n\r\nfunction configureFormsets() {\r\n  let formsets = document.querySelectorAll(\".formset\");\r\n  formsets.forEach(function (formsetEl) {\r\n    new FormsetModal(formsetEl.getAttribute(\"id\"));\r\n  });\r\n}\r\n\r\nfunction configureModals() {\r\n  let modalInstances = [];\r\n  document.querySelectorAll(\"[data-modal-toggle]\").forEach((el) => {\r\n    const modalId = el.getAttribute(\"data-modal-toggle\");\r\n    const modalEl = document.getElementById(modalId);\r\n    const placement = modalEl.getAttribute(\"data-modal-placement\");\r\n\r\n    if (modalEl) {\r\n      if (\r\n        !modalEl.hasAttribute(\"aria-hidden\") &&\r\n        !modalEl.hasAttribute(\"aria-modal\")\r\n      ) {\r\n        modalEl.setAttribute(\"aria-hidden\", \"true\");\r\n      }\r\n    }\r\n\r\n    let modal = null;\r\n    if (getModalInstance(modalId, modalInstances)) {\r\n      modal = getModalInstance(modalId, modalInstances);\r\n      modal = modal.object;\r\n    } else {\r\n      modal = new Modal(modalEl, {\r\n        placement: placement ? placement : Default.placement,\r\n      });\r\n      modalInstances.push({\r\n        id: modalId,\r\n        object: modal,\r\n      });\r\n    }\r\n\r\n    if (\r\n      modalEl.hasAttribute(\"data-modal-show\") &&\r\n      modalEl.getAttribute(\"data-modal-show\") === \"true\"\r\n    ) {\r\n      modal.show();\r\n    }\r\n\r\n    el.addEventListener(\"click\", () => {\r\n      modal.toggle();\r\n    });\r\n  });\r\n}\r\n\r\n$.fn[pluginName] = function () {\r\n  var options, fn, args;\r\n  // Create a new Formset for each element\r\n  if (\r\n    arguments.length === 0 ||\r\n    (arguments.length === 1 && $.type(arguments[0]) != \"string\")\r\n  ) {\r\n    options = arguments[0];\r\n    return this.each(function () {\r\n      return Formset.getOrCreate(this, options);\r\n    });\r\n  }\r\n\r\n  // Call a function on each Formset in the selector\r\n  fn = arguments[0];\r\n  args = $.makeArray(arguments).slice(1);\r\n\r\n  if (fn in Formset) {\r\n    // Call the Formset class method if it exists\r\n    args.unshift(this);\r\n    return Formset[fn].apply(Formset, args);\r\n  } else {\r\n    throw new Error(\"Unknown function call \" + fn + \" for $.fn.formset\");\r\n  }\r\n};\r\n\r\n\r\nready(function () {\r\n  injectStyles();\r\n  configureModals();\r\n  hookCalculatedFields();\r\n  configureFormsets();\r\n  executeAllCalculatedFields();\r\n});\r\n"],"names":["bootstrapPencilIcon","gettext","window","_has","Object","prototype","hasOwnProperty","uuidv4","randomHex","Math","floor","random","toString","substring","parseInt","getTextValue","el","textValue","tagName","toLowerCase","tempDiv","document","createElement","innerHTML","options","selectedIndex","innerText","split","map","item","trim","join","object","key","call","inputmask","undoValue","getAttribute","value","checked","executeAllCalculatedFields","calculatedFields","forEach","obj","executeAll","hookCalculatedFields","field","id","querySelector","hasAttribute","addEventListener","content","_column","setAttribute","getModalInstance","instances","some","modalInstance","find","django","jsi18n_initialized","msg","bootstrap4Classes","hidden","inlineFlex","flex","relative","textRight","textCenter","alignMiddle","pointer","editBtn","checkbox","td","tr","selectionMark","p0","opacity50","opacity100","backdrop","justifyStart","justifyCenter","justifyEnd","itemsStart","itemsCenter","itemsEnd","bootstrap4SizeClasses","sm","md","lg","xl","templatePacks","bootstrap4","classes","sizes","pencilIcon","bootstrap5","tailwind","bulma","pluginName","Formset","constructor","_this","this","opts","$","extend","defaults","$formset","attr","$emptyForm","emptyForm","$body","body","$add","add","formsetPrefix","data","addForm","proxy","click","on","form","$forms","each","i","bindForm","extra","static","rev","hasMaxForms","Error","newIndex","totalFormCount","$managementForm","val","newFormHtml","html","replace","RegExp","$newFormFragment","parseHTML","append","$newForm","filter","newFormCallback","$form","index","prefix","$delete","change","event","is","prop","pattern","removeAttr","trigger","deleteButton","bind","name","length","deletedFormCount","clear","row","not","deleteAll","activeFormCount","openRownum","rownum","maxForms","checkMaxForms","addClass","hasMaxFormsClass","removeClass","animateForms","slideUp","slideDown","modalDefault","placement","size","templatePack","onHide","onShow","onToggle","Modal","targetEl","_targetEl","_parentEl","parentElement","_options","_isHidden","_init","_addEventListeners","_getPlacementClasses","c","classList","_clearSize","_getSizeClasses","firstElementChild","_createBackdrop","backdropEl","_getClasses","offsetWidth","_destroyBackdropEl","remove","that","str","names","element","e","hide","toggle","show","removeAttribute","firstEl","focus","modalFormOptions","parent","modalId","onKeyUp","onClose","onOpen","ModalForm","_modalEl","_modalTitleEl","_modalDeleteBt","_addEvents","getElementById","_createModal","querySelectorAll","close","hasFieldError","fieldId","fieldWrapper","hasError","errorText","error","text","hasNonFieldError","_hiddeDefaultDeleteBt","parentNode","deleteBt","modal","_onModalClose","_onModalShow","closest","openRowBt","isDeleted","isSelected","open","variant","formsetOptions","editText","FormsetModal","elementId","_id","_modalForms","_deleteBt","_table","_tbody","_tfoot","_getVariant","_getTemplatePack","modalSize","_getModalSize","modalPlacement","_getModalPlacement","formset","_emptyState","_checkInitials","_configureSelectAllToggler","_refresh","_getPencilIcon","_getModalFormInstanceByRownum","instance","_onFormsetAdded","_onFormsetDeleted","modals","includes","_newModalForm","push","modalForm","_onModalFormKeyUp","_onModalFormOpen","_onModalFormClose","target","resetCalculatedFields","ctrlKey","keyCode","preventDefault","table","toggler","formsetFormEl","_checker","selectedForm","deleteCheckbox","dispatchEvent","Event","_checkSelectAllState","showDeleteBt","selectAllToggler","recordCount","selected","indeterminate","prevDivSel","divSel","prepend","fields","fieldNames","rows","type","hasSummary","summary","keys","match","groups","sourceId","a","hasChildNodes","removeChild","lastChild","removeChildren","tdSel","selCheckbox","appendChild","tdNumber","Number","tdEdit","fn","args","arguments","getOrCreate","makeArray","slice","unshift","apply","style","head","modalInstances","modalEl","Default","formsetEl","readyState"],"mappings":"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"}