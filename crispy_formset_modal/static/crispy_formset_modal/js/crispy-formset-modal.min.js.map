{"version":3,"file":"crispy-formset-modal.min.js","sources":["../../../../js/src/utils.js","../../../../js/src/formset.js","../../../../js/src/modal.js","../../../../js/src/modal-form.js","../../../../js/src/formset-modal.js","../../../../js/src/index.js"],"sourcesContent":["const _has = Object.prototype.hasOwnProperty;\n/**\n * Checks if the object has the property passed as argument\n */\nexport function has(object, key) {\n  return _has.call(object, key);\n}\n\nexport function uuidv4() {\n  function randomHex() {\n    return Math.floor((1 + Math.random()) * 0x10000)\n      .toString(16)\n      .substring(1);\n  }\n\n  const part1 = randomHex() + randomHex();\n  const part2 = randomHex();\n  const part3 = ((parseInt(randomHex(), 16) & 0x0fff) | 0x4000).toString(16);\n  const part4 = ((parseInt(randomHex(), 16) & 0x3fff) | 0x8000).toString(16);\n  const part5 = randomHex() + randomHex() + randomHex();\n\n  return `${part1}-${part2}-${part3}-${part4}-${part5}`;\n}\n\nexport function getTextValue(el) {\n  let type = el.tagName.toLowerCase();\n  let textValue = \"\";\n  if (type === \"select\") {\n    textValue = el.options[el.selectedIndex].innerText;\n  } else {\n    if (has(el, \"inputmask\")) {\n      textValue = el.inputmask.undoValue;\n    } else {\n      if (el.getAttribute(\"type\") == \"date\") {\n        if (el.value) {\n          textValue = new Date(...el.value.split(\"-\")).toLocaleDateString();\n        }\n      } else {\n        if (el.getAttribute(\"type\") == \"checkbox\") {\n          textValue = el.checked ? \"on\" : \"off\";\n        } else {\n          textValue = el.value;\n        }\n      }\n    }\n  }\n  return textValue;\n}\n\nexport function getNumberValue(value) {\n  return Number(value);\n}\n\nexport function executeAllCalculatedFields() {\n  if (window.hasOwnProperty(\"calculatedFields\")) {\n    calculatedFields.forEach(function (obj) {\n      obj.executeAll();\n    });\n  }\n}\n\nexport function hookCalculatedFields() {\n  if (window.hasOwnProperty(\"calculatedFields\")) {\n    window.calculatedFields.forEach(function (obj) {\n      let el = obj.field;\n      let id = el.getAttribute(\"id\");\n      let column = document.querySelector(\"td[data-source='\" + id + \"']\");\n      if (column) {\n        if (!el.hasAttribute(\"data-event\")) {\n          el.addEventListener(\"oncalculate\", function () {\n            let content = getTextValue(el);\n            // The column element is refetched since the table is recreated on each event\n            let _column = document.querySelector(\n              \"td[data-source='\" + id + \"']\"\n            );\n            if (_column) {\n              _column.innerText = content;\n            }\n          });\n          el.setAttribute(\"data-event\", true);\n        }\n      }\n    });\n  }\n}\n\nexport function removeChildren(a) {\n  while (a.hasChildNodes()) {\n    a.removeChild(a.lastChild);\n  }\n}\n\nexport function injectStyles() {\n  const css = `\n    .cfm-selection-border {\n        position: absolute;\n        top: 0px;\n        bottom: 0px;\n        left: 0px;\n        width: 0.150rem;\n        background-color: rgb(220 53 69 / 1);\n    }\n    .cfm-modal-backdrop {\n        position: fixed;\n        inset: 0px;\n        z-index: 100;\n        background-color: rgb(31 41 55 / 1);\n        opacity: 0;\n        transition-property: opacity;\n        transition-duration: 300ms;\n        transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n    }\n    .cfm-opacity-50 {\n        opacity: 0.5;\n    }\n    .cfm-opacity-100 {\n        opacity: 1;\n    }\n    .cfm-tr.selected{\n      background-color: rgba(0, 0, 0, 0.08) !important;\n    }\n    .cfm .modal-body {\n      max-height: calc(100vh - 150px);\n      overflow-x: auto;\n    }\n    `;\n  const style = document.createElement(\"style\");\n  style.innerHTML = css;\n  document.head.appendChild(style);\n}\n\nexport function getModalInstance(id, instances) {\n  if (instances.some((modalInstance) => modalInstance.id === id)) {\n    return instances.find((modalInstance) => modalInstance.id === id);\n  }\n  return false;\n}\n\nexport function ready(fn) {\n  if (document.readyState !== \"loading\") {\n    fn();\n  } else {\n    document.addEventListener(\"DOMContentLoaded\", fn);\n  }\n}\n","/**\n* Django formset helper\n* Copyright (c) 2013, Ionata Web Solutions\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without\n* modification, are permitted provided that the following conditions are met:\n*\n* Redistributions of source code must retain the above copyright notice, this\n* list of conditions and the following disclaimer.\n*\n* Redistributions in binary form must reproduce the above copyright notice, this\n* list of conditions and the following disclaimer in the documentation and/or\n* other materials provided with the distribution.\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n* ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n* WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n* DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n* FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n* SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n* CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n* OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n* OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nimport { uuidv4 } from \"./utils\";\nimport $ from \"jquery\";\n\nexport const pluginName = 'formset';\n\n\nclass Formset {\n    constructor(el, options) {\n        var _this = this;\n\n        //Defaults:\n        this.opts = $.extend({}, Formset.defaults, options);\n\n        this.$formset = $(el);\n        this.$formset.attr(\"data-uuid\", uuidv4());\n        this.$emptyForm = this.$formset.find(this.opts.emptyForm);\n        this.$body = this.$formset.find(this.opts.body);\n        this.$add = this.$formset.find(this.opts.add);\n\n        this.formsetPrefix = $(el).data('formset-prefix');\n\n        // Bind to the `Add form` button\n        this.addForm = $.proxy(this, 'addForm');\n        this.$add.click(this.addForm);\n\n        // Bind receiver to `formAdded` and `formDeleted` events\n        this.$formset.on('formAdded formDeleted', this.opts.form, $.proxy(this, 'checkMaxForms'));\n\n        // Set up the existing forms\n        this.$forms().each(function (i, form) {\n            var $form = $(form);\n            _this.bindForm($(this), i);\n        });\n\n        // Store a reference to this in the formset element\n        this.$formset.data(pluginName, this);\n\n        var extras = ['animateForms'];\n        $.each(extras, function (i, extra) {\n            if ((extra in _this.opts) && (_this.opts[extra])) {\n                _this[extra]();\n            }\n        });\n    }\n    static getOrCreate(el, options) {\n        var rev = $(el).data(pluginName);\n        if (!rev) {\n            rev = new Formset(el, options);\n        }\n\n        return rev;\n    }\n    addForm() {\n        // Don't proceed if the number of maximum forms has been reached\n        if (this.hasMaxForms()) {\n            throw new Error(\"MAX_NUM_FORMS reached\");\n        }\n\n        var newIndex = this.totalFormCount();\n        this.$managementForm('TOTAL_FORMS').val(newIndex + 1);\n\n        var newFormHtml = this.$emptyForm.html()\n            .replace(new RegExp('__prefix__', 'g'), newIndex)\n            .replace(new RegExp('<\\\\\\\\/script>', 'g'), '</script>');\n\n        var $newFormFragment = $($.parseHTML(newFormHtml, this.$body.document, true));\n        this.$body.append($newFormFragment);\n\n        var $newForm = $newFormFragment.filter(this.opts.form);\n        this.bindForm($newForm, newIndex);\n        if (this.opts.newFormCallback) {\n            this.opts.newFormCallback($newForm);\n        }\n        return $newForm;\n    }\n    /**\n    * Attach any events needed to a new form\n    */\n    bindForm($form, index) {\n        var prefix = this.formsetPrefix + '-' + index;\n        $form.data(pluginName + '__formPrefix', prefix);\n\n        var $delete = $form.find('[name=' + prefix + '-DELETE]');\n\n        // Trigger `formAdded` / `formDeleted` events when delete checkbox value changes\n        $delete.change(function (event) {\n            if ($delete.is(':checked')) {\n                $form.attr('data-formset-form-deleted', '');\n                // Remove required property and pattern attribute to allow submit, back it up to data field\n                $form.find(':required').data(pluginName + '-required-field', true).prop('required', false);\n                $form.find('input[pattern]').each(function () {\n                    var pattern = $(this).attr('pattern');\n                    $(this).data(pluginName + '-field-pattern', pattern).removeAttr('pattern');\n                });\n                $form.trigger('formDeleted');\n            } else {\n                $form.removeAttr('data-formset-form-deleted');\n                // Restore required property and pattern attributes from data field\n                $form.find('*').filter(function () {\n                    return $(this).data(pluginName + '-required-field') === true;\n                }).prop('required', true);\n                $form.find('input').each(function () {\n                    var pattern = $(this).data(pluginName + '-field-pattern');\n                    if (pattern) {\n                        $(this).attr('pattern', pattern);\n                    }\n                });\n                $form.trigger('formAdded');\n            }\n        }).trigger('change');\n\n        var $deleteButton = $form.find(this.opts.deleteButton);\n\n        $deleteButton.bind('click', function () {\n            $delete.attr('checked', true).change();\n        });\n    }\n    $forms() {\n        return this.$body.find(this.opts.form);\n    }\n    $managementForm(name) {\n        return this.$formset.find('[name=' + this.formsetPrefix + '-' + name + ']');\n    }\n    totalFormCount() {\n        return this.$forms().length;\n    }\n    deletedFormCount() {\n        return this.$forms().filter('[data-formset-form-deleted]').length;\n    }\n    clear() {\n        this.$forms().each(function (key, row) {\n            $(row).find(':input').not(':button, :submit, :reset, :hidden, :checkbox, :radio').val('');\n        });\n    }\n    deleteAll() {\n        this.$forms().each(function (key, row) {\n            $(row).find('[deletecheckbox]').prop(\"checked\", true).change();\n        });\n    }\n    activeFormCount() {\n        return this.totalFormCount() - this.deletedFormCount();\n    }\n    openRownum() {\n        var rownum = this.$formset.find('tr.row-open').attr('data-rownum');\n        return typeof rownum != undefined ? parseInt(rownum) : 0;\n    }\n    hasMaxForms() {\n        var maxForms = parseInt(this.$managementForm('MAX_NUM_FORMS').val(), 10) || 1000;\n        return this.activeFormCount() >= maxForms;\n    }\n    checkMaxForms() {\n        if (this.hasMaxForms()) {\n            this.$formset.addClass(this.opts.hasMaxFormsClass);\n            this.$add.attr('disabled', 'disabled');\n        } else {\n            this.$formset.removeClass(this.opts.hasMaxFormsClass);\n            this.$add.removeAttr('disabled');\n        }\n    }\n    animateForms() {\n        this.$formset.on('formAdded', this.opts.form, function () {\n            var $form = $(this);\n            $form.slideUp(0);\n            $form.slideDown();\n        }).on('formDeleted', this.opts.form, function () {\n            var $form = $(this);\n            $form.slideUp();\n        });\n        this.$forms().filter('[data-formset-form-deleted]').slideUp(0);\n    }\n}\n\nFormset.defaults = {\n    form: '[data-formset-form]',\n    emptyForm: 'script[type=form-template][data-formset-empty-form]',\n    body: '[data-formset-body]',\n    add: '[data-formset-add]',\n    deleteButton: '[data-formset-delete-button]',\n    hasMaxFormsClass: 'has-max-forms',\n    animateForms: false,\n    newFormCallback: false\n};\n\nexport default Formset;\n","import { uuidv4 } from \"./utils\";\n\nconst bootstrap4SizeClasses = {\n  sm: \"modal-sm\",\n  md: \"modal-md\",\n  lg: \"modal-lg\",\n  xl: \"modal-xl\",\n};\n\nconst bootstrap5SizeClasses = bootstrap4SizeClasses;\n\nconst templatePacks = {\n  bootstrap4: { sizes: bootstrap4SizeClasses },\n  bootstrap5: { sizes: bootstrap5SizeClasses },\n};\n\nconst modalDefault = {\n  placement: \"center\",\n  size: \"md\",\n  backdropClasses: \"cfm-modal-backdrop\",\n  templatePack: null,\n  onHide: () => {},\n  onShow: () => {},\n  onToggle: () => {},\n};\n\nclass Modal {\n  constructor(targetEl = null, options = {}) {\n    this._targetEl = targetEl;\n    this._parentEl = targetEl.parentElement;\n    this._options = {\n      ...modalDefault,\n      ...options,\n    };\n    this._isHidden = true;\n    this._init();\n    this._addEventListeners();\n  }\n  _init() {\n    this._getPlacementClasses().map((c) => {\n      this._targetEl.classList.add(c);\n    });\n    this._clearSize();\n    this._getSizeClasses().map((c) => {\n      this._targetEl.firstElementChild.classList.add(c);\n    });\n  }\n  _createBackdrop(id) {\n    if (this._isHidden) {\n      const backdropEl = document.createElement(\"div\");\n      backdropEl.setAttribute(\"data-ref-id\", id);\n      backdropEl.setAttribute(\"modal-backdrop\", \"\");\n      backdropEl.classList.add(...this._options.backdropClasses.split(\" \"));\n      this._parentEl.append(backdropEl);\n      backdropEl.offsetWidth;\n      backdropEl.classList.add(\"cfm-opacity-50\");\n    }\n  }\n  _destroyBackdropEl() {\n    if (!this._isHidden) {\n      let id = this._targetEl.getAttribute(\"data-ref-id\");\n      document.querySelector(`[modal-backdrop][data-ref-id=\"${id}\"]`).remove();\n    }\n  }\n  _getPlacementClasses() {\n    switch (this._options.placement) {\n      // top\n      case \"top-left\":\n        return [\"justify-content-start\", \"align-items-start\"];\n      case \"top-center\":\n        return [\"justify-content-center\", \"align-items-start\"];\n      case \"top-right\":\n        return [\"justify-content-end\", \"align-items-start\"];\n\n      // center\n      case \"center-left\":\n        return [\"justify-content-start\", \"align-items-center\"];\n      case \"center\":\n        return [\"justify-content-center\", \"align-items-center\"];\n      case \"center-right\":\n        return [\"justify-content-end\", \"align-items-center\"];\n\n      // bottom\n      case \"bottom-left\":\n        return [\"justify-content-start\", \"align-items-end\"];\n      case \"bottom-center\":\n        return [\"justify-content-center\", \"align-items-end\"];\n      case \"bottom-right\":\n        return [\"justify-content-end\", \"align-items-end\"];\n\n      default:\n        return [\"justify-content-center\", \"align-items-center\"];\n    }\n  }\n  _getSizeClasses() {\n    return templatePacks[this._options.templatePack].sizes[\n      this._options.size\n    ].split(\" \");\n  }\n  _clearSize() {\n    const element = this._targetEl.firstElementChild;\n    const obj = templatePacks[this._options.templatePack].sizes;\n    for (const key in obj) {\n      if (obj.hasOwnProperty(key)) {\n        element.classList.remove(obj[key]);\n      }\n    }\n  }\n  _addEventListeners() {\n    let that = this;\n    this._targetEl.addEventListener(\"keyup\", function (e) {\n      if (e.key === \"Escape\") {\n        that.hide();\n      }\n    });\n  }\n  toggle() {\n    if (this._isHidden) {\n      this.show();\n    } else {\n      this.hide();\n    }\n\n    // callback function\n    this._options.onToggle(this);\n  }\n  show() {\n    const id = uuidv4();\n    this._targetEl.classList.add(\"d-flex\");\n    this._targetEl.classList.remove(\"d-none\");\n    this._targetEl.setAttribute(\"aria-modal\", \"true\");\n    this._targetEl.setAttribute(\"role\", \"dialog\");\n    this._targetEl.removeAttribute(\"aria-hidden\");\n    this._targetEl.setAttribute(\"data-ref-id\", id);\n    this._createBackdrop(id);\n    this._isHidden = false;\n\n    document.body.classList.add(\"modal-open\");\n\n    // callback function\n    this._options.onShow(this);\n\n    let firstEl = this._targetEl.querySelector(\n      'select, input:not([type=\"hidden\"]'\n    );\n    if (firstEl) {\n      firstEl.setAttribute(\"tabindex\", \"0\");\n      firstEl.focus();\n    }\n    this._targetEl.offsetWidth;\n    this._targetEl.classList.add(\"cfm-opacity-100\");\n  }\n  hide() {\n    this._targetEl.classList.add(\"d-none\");\n    this._targetEl.classList.remove(\"d-flex\");\n    this._targetEl.setAttribute(\"aria-hidden\", \"true\");\n    this._targetEl.removeAttribute(\"aria-modal\");\n    this._targetEl.removeAttribute(\"role\");\n    this._destroyBackdropEl();\n    this._isHidden = true;\n\n    document.body.classList.remove(\"modal-open\");\n\n    // callback function\n    this._options.onHide(this);\n  }\n}\n\nexport default Modal;\n","import Modal from \"./modal\";\n\nconst modalFormOptions = {\n  parent: null,\n  modalId: null,\n  onKeyUp: function () {},\n  onClose: function () {},\n  onOpen: function () {},\n};\n\nclass ModalForm {\n  constructor(targetEl, options = {}) {\n    this.targetEl = targetEl;\n    this._options = {\n      ...modalFormOptions,\n      ...options,\n    };\n    this.modalId = this._options.modalId;\n    this._modalEl = null;\n    this._modalTitleEl = null;\n    this._modalDeleteBt = null;\n    this.modalInstance = false;\n    this.rownum = null;\n    this._init();\n    this._addEvents();\n  }\n  _init() {\n    this._modalEl = document.getElementById(this.modalId);\n    this._modalTitleEl = this._modalEl.querySelector(\".modal-title\");\n    this._modalDeleteBt = this._modalEl.querySelector(\".formset-delete\");\n    this._createModal();\n  }\n  _addEvents() {\n    let that = this;\n    this._modalEl\n      .querySelectorAll('[data-formset-modal-toggle=\"' + this.modalId + '\"]')\n      .forEach(function (el) {\n        el.addEventListener(\"click\", function () {\n          that.close();\n        });\n      });\n  }\n  hasFieldError(fieldId) {\n    let fieldWrapper = this.targetEl.querySelector(`#div_${fieldId}`);\n    let hasError = false;\n    let errorText = \"\";\n    fieldWrapper.querySelectorAll(\".field-error\").forEach(function (el) {\n      hasError = true;\n      errorText = el.innerText;\n    });\n    return { error: hasError, text: errorText };\n  }\n  hasNonFieldError() {\n    return this.targetEl.querySelector(\".non-field-errors\") != null;\n  }\n  _hiddeDefaultDeleteBt(el) {\n    let parentEl = el.parentNode;\n    parentEl.classList.add(\"d-none\");\n  }\n  _createModal() {\n    let that = this;\n    if (!this.modalInstance) {\n      let deleteBt = this.targetEl.querySelector(\".formset-delete\");\n      let modal = new Modal(this._modalEl, {\n        placement: that._options.placement,\n        size: that._options.size,\n        templatePack: that._options.templatePack,\n        onHide: function (modal) {\n          that._onModalClose(modal);\n        },\n        onShow: function (modal) {\n          that._onModalShow(modal);\n        },\n      });\n      modal._targetEl.addEventListener(\"keyup\", function (e) {\n        that._options.onKeyUp(e, that);\n      });\n      this.modalInstance = modal;\n      this._hiddeDefaultDeleteBt(deleteBt);\n    }\n  }\n  _onModalShow(modal) {\n    this._options.onOpen(this);\n    let openRowBt = this._options.parent.targetEl.querySelector(\n      \".btn-open-row[data-formset-modal-toggle='\" + this.modalId + \"']\"\n    );\n    let tr = openRowBt.closest(\"tr\");\n    this._modalTitleEl.innerText = \"Editing row #\" + this.rownum;\n    tr.classList.add(\"row-open\");\n  }\n  _onModalClose(modal) {\n    this._options.onClose(this);\n    let openRowBt = this._options.parent.targetEl.querySelector(\n      \".btn-open-row[data-formset-modal-toggle='\" + this.modalId + \"']\"\n    );\n    if (openRowBt) {\n      let tr = openRowBt.closest(\"tr\");\n      tr.classList.remove(\"row-open\");\n    }\n  }\n  isDeleted() {\n    return this.targetEl.hasAttribute(\"data-formset-form-deleted\");\n  }\n  isSelected() {\n    return this.targetEl.hasAttribute(\"data-formset-form-selected\");\n  }\n  open() {\n    this.modalInstance.show();\n  }\n  close() {\n    this.modalInstance.hide();\n  }\n}\n\nexport default ModalForm;\n","import $ from \"jquery\";\nimport ModalForm from \"./modal-form\";\nimport {\n  executeAllCalculatedFields,\n  getNumberValue,\n  getTextValue,\n  hookCalculatedFields,\n  uuidv4,\n  removeChildren,\n} from \"./utils\";\n\nconst variant = {\n  tabular: \"tabular\",\n  stacked: \"stacked\",\n  modal: \"modal\",\n};\n\nconst pencilSvg = `\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-pencil\" viewBox=\"0 0 16 16\">\n    <path d=\"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z\"/>\n</svg>\n`;\n\nconst formsetOptions = {\n  checkboxClasses: \"checkbox\",\n  selectionMarkClasses: \"cfm-selection-border\",\n  tdClasses: \"cfm-td\",\n  trClasses: \"cfm-tr\",\n  editText: \"Editar\",\n  pencilIcon: pencilSvg,\n};\n\nclass FormsetModal {\n  constructor(elementId) {\n    this._id = elementId;\n    this.targetEl = document.getElementById(this._id);\n    this.variant = variant.tabular;\n    this.$formset = null;\n    this._options = {\n      ...formsetOptions,\n    };\n    this._modalForms = [];\n    this._deleteBt = null;\n    this._table = null;\n    this._tbody = null;\n    this._tfoot = null;\n    this._init();\n    this._addEvents();\n  }\n  _init() {\n    this.variant = this._getVariant();\n    this.templatePack = this._getTemplatePack();\n    this.modalSize = this._getModalSize();\n    this.modalPlacement = this._getModalPlacement();\n    // Create Formset Helper Instance\n    this.$formset = $(`#${this._id}`);\n    this.$formset.formset({\n      animateForms: true,\n    });\n    if (this.variant === variant.modal || this.variant == variant.tabular) {\n      this._table = this.targetEl.querySelector(\"table\");\n      this._tbody = this._table.querySelector(\"tbody\");\n      this._tfoot = this._table.querySelector(\"tfoot\");\n      this._emptyState = this._tbody.innerHTML;\n    }\n    if (this.variant === variant.modal) {\n      this._deleteBt = this.targetEl.querySelector(\".delete-selected\");\n      this._checkInitials();\n      this._configureSelectAllToggler();\n      this._refresh();\n    }\n  }\n  _getVariant() {\n    return this.targetEl.getAttribute(\"data-formset-variant\");\n  }\n  _getTemplatePack(){\n    return this.targetEl.getAttribute(\"data-template-pack\");\n  }\n  _getModalSize(){\n    return this.targetEl.getAttribute(\"data-modal-size\");\n  }\n  _getModalPlacement(){\n    return this.targetEl.getAttribute(\"data-modal-placement\");\n  }\n  _getModalFormInstanceByRownum(rownum) {\n    let instance = false;\n    this._modalForms.forEach(function (obj) {\n      if (obj.rownum === rownum && !obj.isDeleted()) {\n        instance = obj;\n      }\n    });\n    return instance;\n  }\n  _addEvents() {\n    let that = this;\n    this.$formset.on(\"formAdded\", function (e) {\n      that._onFormsetAdded(e);\n    });\n    this.$formset.on(\"formDeleted\", function (e) {\n      that._onFormsetDeleted(e);\n    });\n  }\n  /**\n   * Check if the page loaded form from the server to configure them.\n   */\n  _checkInitials() {\n    let that = this;\n    let modals = [];\n    this.targetEl\n      .querySelectorAll(\"[data-formset-modal-toggle]\")\n      .forEach(function (el) {\n        let targetEl = el.closest(\"[data-formset-form]\");\n        let modalId = el.getAttribute(\"data-formset-modal-toggle\");\n        if (!modals.includes(modalId)) {\n          that._newModalForm(targetEl, modalId);\n        }\n        modals.push(modalId);\n      });\n  }\n  _newModalForm(targetEl, modalId) {\n    let that = this;\n    let options = {\n      parent: that,\n      modalId: modalId,\n      size: this.modalSize,\n      placement: this.modalPlacement,\n      templatePack: that.templatePack,\n      onKeyUp: function (e, modalForm) {\n        that._onModalFormKeyUp(e, modalForm);\n      },\n      onOpen: function (modalForm) {\n        that._onModalFormOpen(modalForm);\n      },\n      onClose: function (modalForm) {\n        that._onModalFormClose(modalForm);\n      },\n    };\n    let modalForm = new ModalForm(targetEl, options);\n    that._modalForms.push(modalForm);\n    return modalForm;\n  }\n  _onFormsetAdded(e) {\n    if (this.variant === variant.modal) {\n      let id = uuidv4();\n      $(this.targetEl).find(\"#__dialog_id__\").attr(\"id\", id);\n      $(this.targetEl)\n        .find('[data-formset-modal-toggle=\"__dialog_id__\"]')\n        .attr(\"data-formset-modal-toggle\", id);\n      let modalForm = this._newModalForm(e.target, id);\n      modalForm.open();\n    }\n    if (window.hasOwnProperty(\"calculatedFields\")) {\n      window.resetCalculatedFields();\n      hookCalculatedFields();\n    }\n  }\n  _onFormsetDeleted() {\n    if (this.variant == variant.modal) {\n      this._refresh();\n    }\n    executeAllCalculatedFields();\n  }\n  _onModalFormKeyUp(e, modalForm) {\n    if (e.ctrlKey && (e.keyCode === 38 || e.keyCode === 40)) {\n      e.preventDefault();\n      let openRownum = modalForm.rownum;\n      let $formset = this.$formset.formset(\"getOrCreate\");\n      let activeFormCount = $formset.activeFormCount();\n      if (e.keyCode == 38) {\n        // Up\n        if (openRownum > 1) {\n          modalForm.close();\n          let previewsModalForm = this._getModalFormInstanceByRownum(\n            openRownum - 1\n          );\n          previewsModalForm.open();\n        }\n      }\n\n      if (e.keyCode === 40) {\n        // Down\n        if (openRownum < activeFormCount) {\n          modalForm.close();\n          let nextsModalForm = this._getModalFormInstanceByRownum(\n            openRownum + 1\n          );\n          nextsModalForm.open();\n        }\n        if (openRownum == activeFormCount) {\n          modalForm.close();\n          $formset.addForm();\n        }\n      }\n    }\n  }\n  _onModalFormOpen(modalForm) {\n    this._refresh();\n  }\n  _onModalFormClose(modalForm) {\n    this._refresh();\n  }\n  _configureSelectAllToggler() {\n    let that = this;\n    let table = this._table;\n    let toggler = this.targetEl.querySelector(\".select-all\");\n    let deleteBt = this.targetEl.querySelector(\".delete-selected\");\n\n    toggler.addEventListener(\"change\", function (e) {\n      let checked = toggler.checked;\n      let checkBoxes = table.querySelectorAll(\".select-row\");\n      checkBoxes.forEach(function (checkbox) {\n        let tr = checkbox.closest(\"tr\");\n        let td = checkbox.closest(\"td\");\n        let btnOpenRow = tr.querySelector(\"[data-formset-modal-toggle]\");\n        let modalId = btnOpenRow.getAttribute(\"data-formset-modal-toggle\");\n        let modalEl = document.getElementById(modalId);\n        let formsetFormEl = modalEl.closest(\"[data-formset-form]\");\n        checkbox.checked = checked;\n        that._checker(tr, td, formsetFormEl, checkbox);\n      });\n    });\n\n    deleteBt.addEventListener(\"click\", function (e) {\n      let formset = that.targetEl;\n      let selectedForms = formset.querySelectorAll(\n        \"[data-formset-form-selected]\"\n      );\n      selectedForms.forEach(function (selectedForm) {\n        let deleteCheckbox = selectedForm.querySelector(\".formset-delete\");\n        deleteCheckbox.checked = true;\n        deleteCheckbox.dispatchEvent(new Event(\"change\"));\n      });\n    });\n  }\n  _checkSelectAllState() {\n    let table = this._table;\n    let formset = this.targetEl;\n    let deleteBt = formset.querySelector(\".delete-selected\");\n    let showDeleteBt = false;\n    let selectAllToggler = table.querySelector(\".select-all\");\n    let recordCount = table.querySelectorAll(\"tbody tr\").length;\n    let selected = table.querySelectorAll(\"tr.selected\").length;\n\n    if (selected === recordCount && recordCount > 0) {\n      selectAllToggler.checked = true;\n      selectAllToggler.indeterminate = false;\n      showDeleteBt = true;\n    } else {\n      if (selected != recordCount && selected > 0) {\n        selectAllToggler.indeterminate = true;\n        selectAllToggler.checked = false;\n        showDeleteBt = true;\n      }\n      if (selected === 0) {\n        selectAllToggler.checked = false;\n        selectAllToggler.indeterminate = false;\n        showDeleteBt = false;\n      }\n    }\n\n    if (showDeleteBt) {\n      deleteBt.classList.remove(\"d-none\");\n      deleteBt.classList.add(\"d-inline-flex\");\n    } else {\n      deleteBt.classList.remove(\"d-inline-flex\");\n      deleteBt.classList.add(\"d-none\");\n    }\n  }\n  _checker(tr, td, formsetFormEl, checkbox) {\n    // remove previous divSel if exists.\n    let prevDivSel = td.querySelector(\".cfm-selection-border\");\n    if (prevDivSel) {\n      prevDivSel.remove();\n    }\n    if (checkbox.checked) {\n      let divSel = document.createElement(\"div\");\n      td.classList.add(\"position-relative\");\n      divSel.classList.add(...this._options.selectionMarkClasses.split(\" \"));\n      td.prepend(divSel);\n      formsetFormEl.setAttribute(\"data-formset-form-selected\", \"selected\");\n      tr.classList.add(\"selected\");\n    } else {\n      checkbox.classList.remove(\"position-relative\");\n      tr.classList.remove(\"selected\");\n      formsetFormEl.removeAttribute(\"data-formset-form-selected\");\n    }\n    this._checkSelectAllState();\n  }\n  _refresh() {\n    let that = this;\n    let fields = {};\n    let fieldNames = [];\n    let rows = [];\n\n    this._table.querySelectorAll(\"[data-field-name]\").forEach(function (el) {\n      fields[el.getAttribute(\"data-field-name\")] = {\n        type: el.getAttribute(\"data-field-type\"),\n        hasSummary: el.hasAttribute(\"data-field-summary\"),\n        summary: 0,\n      };\n    });\n\n    fieldNames = Object.keys(fields);\n\n    this._modalForms.forEach(function (modalForm) {\n      if (!modalForm.isDeleted()) {\n        let row = {};\n        modalForm.targetEl\n          .querySelectorAll(\"input, select\")\n          .forEach(function (el) {\n            let match = el.name.match(\n              /(?<form>\\w+)-(?<number>\\w+)-(?<name>\\w+)/\n            );\n            if (match) {\n              let name = match.groups.name;\n              if (fieldNames.includes(name)) {\n                let content = getTextValue(el);\n                row[name] = {\n                  value: content,\n                  sourceId: el.getAttribute(\"id\"),\n                };\n                row[\"modalForm\"] = modalForm;\n              }\n            }\n          });\n        rows.push(row);\n      }\n    });\n\n    // Remove all rows\n    removeChildren(this._tbody);\n\n    if (rows.length === 0) {\n      this._tbody.innerHTML = this._emptyState;\n    }\n\n    let rownum = 1;\n    rows.forEach(function (row) {\n      row.modalForm.rownum = rownum;\n      // Table row\n      let tr = document.createElement(\"tr\");\n      tr.classList.add(...that._options.trClasses.split(\" \"));\n      tr.setAttribute(\"data-rownum\", rownum);\n      // Highlight row if there are non field errors\n      if (row.modalForm.hasNonFieldError()) {\n        tr[\"style\"] = \"border: 1px solid #ff4545\";\n      }\n      // Selection column\n      let tdSel = document.createElement(\"td\");\n      let selCheckbox = document.createElement(\"input\");\n      selCheckbox.setAttribute(\"type\", \"checkbox\");\n      selCheckbox.classList.add(...that._options.checkboxClasses.split(\" \"));\n      selCheckbox.classList.add(\"select-row\");\n      tdSel.appendChild(selCheckbox);\n      //tdSel.classList.add('w-10');\n      //tdSel.classList.add('text-center', 'dark:bg-gray-700', 'dark:border-gray-600');\n      selCheckbox.addEventListener(\"change\", function (e) {\n        that._checker(tr, tdSel, row.modalForm.targetEl, e.target);\n      });\n      tr.appendChild(tdSel);\n      // Column for row number\n      let tdNumber = document.createElement(\"td\");\n      tdNumber.classList.add(...that._options.tdClasses.split(\" \"));\n      tdNumber.classList.add(\"w-10\");\n      tdNumber.classList.add(\"text-right\");\n      tdNumber.classList.add(\"cursor-pointer\");\n      tdNumber.innerText = rownum;\n      tdNumber.addEventListener(\"click\", function () {\n        row.modalForm.open();\n      });\n      tr.appendChild(tdNumber);\n      // Mirror columns\n      fieldNames.forEach(function (field) {\n        let td = document.createElement(\"td\");\n        let hasError = row.modalForm.hasFieldError(row[field].sourceId);\n        td.classList.add(...that._options.tdClasses.split(\" \"));\n        if (hasError.error) {\n          td[\"style\"] = \"border: 1px solid #ff4545\";\n          td[\"title\"] = hasError.text;\n        }\n        if (fields[field].type === \"bool\") {\n          checked = row[field].value === \"on\" ? \"checked\" : \"\";\n          td.innerHTML = `<input type=\"checkbox\" class=\"${that._options.checkboxClasses}\" ${checked} disabled></input>`;\n        } else {\n          td.innerText = row[field].value;\n        }\n        if (fields[field].type === \"numeric\") {\n          td.classList.add(\"text-right\");\n          if (fields[field].hasSummary) {\n            fields[field].summary =\n              fields[field].summary + getNumberValue(row[field].value);\n          }\n        }\n        if (fields[field].type === \"bool\" || fields[field].type == \"date\") {\n          td.classList.add(\"text-center\");\n        }\n        td.setAttribute(\"data-source\", row[field].sourceId);\n        tr.appendChild(td);\n      });\n      // Column for edit button\n      let tdEdit = document.createElement(\"td\");\n      tdEdit.classList.add(...that._options.tdClasses.split(\" \"));\n      tdEdit.classList.add(\"w-16\");\n      tdEdit.classList.add(\"text-center\");\n      tdEdit.classList.add(\"p-0\")\n      tdEdit.classList.add(\"align-middle\")\n      tdEdit.innerHTML = `\n                <button title=\"${that._options.editText}\" \n                        class=\"btn-open-row btn btn-sm btn btn-primary\"\n                        data-formset-modal-toggle=\"${row.modalForm.modalId}\">\n                        ${that._options.pencilIcon}\n                </button>`;\n      let button = tdEdit.querySelector(\".btn-open-row\");\n\n      button.addEventListener(\"click\", function (e) {\n        row.modalForm.open();\n      });\n\n      tr.appendChild(tdEdit);\n      that._tbody.appendChild(tr);\n\n      if (row.modalForm.isSelected()) {\n        selCheckbox.checked = true;\n        that._checker(tr, tdSel, row.modalForm.targetEl, selCheckbox);\n      }\n\n      rownum++;\n    });\n\n    if (this._tfoot) {\n      this._tfoot\n        .querySelectorAll(\"[data-summary-column]\")\n        .forEach(function (el) {\n          let summary = fields[el.getAttribute(\"data-summary-column\")].summary;\n          el.innerText = summary;\n        });\n    }\n\n    this._checkSelectAllState();\n  }\n}\n\nexport default FormsetModal;\n","import $ from \"jquery\";\nimport Formset, { pluginName } from \"./formset\";\nimport FormsetModal from \"./formset-modal\";\nimport Modal from \"./modal\";\nimport {\n  executeAllCalculatedFields,\n  getModalInstance,\n  hookCalculatedFields,\n  ready,\n  injectStyles,\n} from \"./utils\";\n\nfunction configureFormsets() {\n  let formsets = document.querySelectorAll(\".formset\");\n  formsets.forEach(function (formsetEl) {\n    new FormsetModal(formsetEl.getAttribute(\"id\"));\n  });\n}\n\nfunction configureModals() {\n  let modalInstances = [];\n  document.querySelectorAll(\"[data-modal-toggle]\").forEach((el) => {\n    const modalId = el.getAttribute(\"data-modal-toggle\");\n    const modalEl = document.getElementById(modalId);\n    const placement = modalEl.getAttribute(\"data-modal-placement\");\n\n    if (modalEl) {\n      if (\n        !modalEl.hasAttribute(\"aria-hidden\") &&\n        !modalEl.hasAttribute(\"aria-modal\")\n      ) {\n        modalEl.setAttribute(\"aria-hidden\", \"true\");\n      }\n    }\n\n    let modal = null;\n    if (getModalInstance(modalId, modalInstances)) {\n      modal = getModalInstance(modalId, modalInstances);\n      modal = modal.object;\n    } else {\n      modal = new Modal(modalEl, {\n        placement: placement ? placement : Default.placement,\n      });\n      modalInstances.push({\n        id: modalId,\n        object: modal,\n      });\n    }\n\n    if (\n      modalEl.hasAttribute(\"data-modal-show\") &&\n      modalEl.getAttribute(\"data-modal-show\") === \"true\"\n    ) {\n      modal.show();\n    }\n\n    el.addEventListener(\"click\", () => {\n      modal.toggle();\n    });\n  });\n}\n\n$.fn[pluginName] = function () {\n  var options, fn, args;\n  // Create a new Formset for each element\n  if (\n    arguments.length === 0 ||\n    (arguments.length === 1 && $.type(arguments[0]) != \"string\")\n  ) {\n    options = arguments[0];\n    return this.each(function () {\n      return Formset.getOrCreate(this, options);\n    });\n  }\n\n  // Call a function on each Formset in the selector\n  fn = arguments[0];\n  args = $.makeArray(arguments).slice(1);\n\n  if (fn in Formset) {\n    // Call the Formset class method if it exists\n    args.unshift(this);\n    return Formset[fn].apply(Formset, args);\n  } else {\n    throw new Error(\"Unknown function call \" + fn + \" for $.fn.formset\");\n  }\n};\n\nready(function () {\n  injectStyles();\n  configureModals();\n  hookCalculatedFields();\n  configureFormsets();\n  executeAllCalculatedFields();\n});\n"],"names":["_has","has","object","key","uuidv4","randomHex","part1","part2","part3","part4","part5","getTextValue","el","type","textValue","getNumberValue","value","executeAllCalculatedFields","obj","hookCalculatedFields","id","content","_column","removeChildren","a","injectStyles","css","style","getModalInstance","instances","modalInstance","ready","fn","pluginName","Formset","options","_this","$","form","extras","extra","rev","newIndex","newFormHtml","$newFormFragment","$newForm","$form","index","prefix","$delete","event","pattern","$deleteButton","name","row","rownum","maxForms","bootstrap4SizeClasses","templatePacks","modalDefault","Modal","targetEl","c","backdropEl","element","that","firstEl","modalFormOptions","ModalForm","fieldId","fieldWrapper","hasError","errorText","deleteBt","modal","e","tr","openRowBt","variant","formsetOptions","FormsetModal","elementId","instance","modals","modalId","modalForm","openRownum","$formset","activeFormCount","table","toggler","checked","checkbox","td","formsetFormEl","selectedForm","deleteCheckbox","showDeleteBt","selectAllToggler","recordCount","selected","prevDivSel","divSel","fields","fieldNames","rows","match","tdSel","selCheckbox","tdNumber","field","tdEdit","summary","configureFormsets","formsetEl","configureModals","modalInstances","modalEl","placement","args"],"mappings":"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"}